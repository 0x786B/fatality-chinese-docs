# ğŸ—³ï¸ Events

ç”¨æ³•ï¼š`events.{event_name}`

Fatality åœ¨ API ä¸­æä¾›äº†è®¸å¤šäº‹ä»¶ä¾›ä½¿ç”¨ - ä»å„ç§é’©å­åˆ°æ¸¸æˆå†…äº‹ä»¶ã€‚æ¯ä¸ªäº‹ä»¶æ¡ç›®éƒ½æ˜¯ [`event_t`](/api/events/event-t "äº‹ä»¶ç”¨æˆ·ç±»å‹ã€‚æ­¤ç±»å‹çš„å®ä¾‹å¯ä»¥åœ¨ events ä¸­æ‰¾åˆ°ã€‚") ç±»å‹çš„å¯¹è±¡ã€‚æœ¬è¡¨è®°å½•äº†æ‚¨çš„è„šæœ¬å¯ä»¥ä½¿ç”¨çš„äº‹ä»¶ã€‚

> å½“æ‚¨çš„è„šæœ¬å¸è½½æ—¶ï¼Œä¸éœ€è¦æ‰‹åŠ¨ç§»é™¤äº‹ä»¶ã€‚API å¼•æ“ä¼šè‡ªåŠ¨å®Œæˆè¿™ä¸ªæ“ä½œã€‚

_________________
### present_queue

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

åœ¨æ¸¸æˆæ¯æ¬¡å°†å¸§æ’é˜Ÿè¿›è¡Œæ¸²æŸ“æ—¶è°ƒç”¨ã€‚è¿™æ˜¯å”¯ä¸€å…è®¸åœ¨å±å¹•ä¸Šç»˜åˆ¶çš„ä½ç½®ã€‚

**å‚æ•°**

æ— ã€‚

**ç¤ºä¾‹**

```lua
events.present_queue:add(function()
  print('present_queue')
end)
```

### create_move

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

åœ¨æ¸¸æˆæ¯æ¬¡åˆ›å»ºç§»åŠ¨æ—¶è°ƒç”¨ã€‚

**å‚æ•°**

| åç§° | ç±»å‹ | æè¿° |
| ---- | ---- | ----------- |
| `cmd` | [`cuser_cmd`](api/types/cuser-cmd.md) | ç”¨æˆ·å‘½ä»¤ã€‚ |

**ç¤ºä¾‹**

```lua
events.create_move:add(function(cmd)
  --
end)
```

### frame_stage_notify

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

åœ¨æ¸¸æˆæ¯æ¬¡è¿›å…¥æ–°çš„å¸§é˜¶æ®µæ—¶è°ƒç”¨ã€‚æ­¤äº‹ä»¶åœ¨æ¸¸æˆå¤„ç†æ–°å¸§é˜¶æ®µä¹‹å‰è°ƒç”¨ã€‚

**å‚æ•°**

| åç§° | ç±»å‹ | æè¿° |
| ---- | ---- | ----------- |
| `stage` | [`client_frame_stage`](/api/common-enums/client-frame-stage "åŒ…å«å„ç§å¸§æ¸²æŸ“é˜¶æ®µçš„é”®ã€‚") | å½“å‰å¸§é˜¶æ®µã€‚ |

**ç¤ºä¾‹**

```lua
events.frame_stage_notify:add(function(stage)
  print('New frame stage:', stage)
end)
```

### render_start_pre

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

åœ¨æ¸¸æˆæ¯æ¬¡å¼€å§‹åœºæ™¯æ¸²æŸ“è¿‡ç¨‹æ—¶è°ƒç”¨ã€‚æ­¤äº‹ä»¶åœ¨æ¸¸æˆå‡½æ•°è¿è¡Œä¹‹å‰è°ƒç”¨ã€‚

**å‚æ•°**

æ— ã€‚

**ç¤ºä¾‹**

```lua
events.render_start_pre:add(function()
  print('Rendering started')
end)
```

### render_start_post

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

åœ¨æ¸¸æˆæ¯æ¬¡å¼€å§‹åœºæ™¯æ¸²æŸ“è¿‡ç¨‹æ—¶è°ƒç”¨ã€‚æ­¤äº‹ä»¶åœ¨æ¸¸æˆå‡½æ•°è¿è¡Œä¹‹åè°ƒç”¨ã€‚

**å‚æ•°**

| åç§° | ç±»å‹ | æè¿° |
| ---- | ---- | ----------- |
| `setup` | [`cview_setup`](/api/common-types/cview-setup "æè¿°è§†å›¾è®¾ç½®å‚æ•°ã€‚") | è§†å›¾è®¾ç½®ä¿¡æ¯ã€‚ |

**ç¤ºä¾‹**

```lua
events.render_start_post:add(function(setup)
  print('Rendering completed with setup:', setup)
end)
```

### setup_view_pre

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

åœ¨æ¸¸æˆæ¯æ¬¡è®¾ç½®è§†å›¾æ—¶è°ƒç”¨ã€‚æ­¤äº‹ä»¶åœ¨æ¸¸æˆå‡½æ•°è¿è¡Œ**ä¹‹å‰**è°ƒç”¨ã€‚

**å‚æ•°**

æ— ã€‚

**ç¤ºä¾‹**

```lua
events.setup_view_pre:add(function()
  print('View setup started')
end)
```

### setup_view_post

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

åœ¨æ¸¸æˆæ¯æ¬¡è®¾ç½®è§†å›¾ä¿¡æ¯æ—¶è°ƒç”¨ã€‚æ­¤äº‹ä»¶åœ¨æ¸¸æˆå‡½æ•°è¿è¡Œ**ä¹‹å**è°ƒç”¨ã€‚

> æ‚¨å¯ä»¥ä» `game.view_render` æœåŠ¡ä¸­è·å–è§†å›¾ä¿¡æ¯ã€‚

**å‚æ•°**

æ— ã€‚

**ç¤ºä¾‹**

```lua
events.setup_view_post:add(function()
  print('View setup completed')
end)
```

### override_view

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

åœ¨æ¸¸æˆæ¯æ¬¡å†…éƒ¨è¦†ç›–è§†å›¾ä¿¡æ¯æ—¶è°ƒç”¨ã€‚æ‚¨å¯ä»¥è‡ªç”±æ›´æ”¹æä¾›çš„è§†å›¾è®¾ç½®ä¸­çš„ä»»ä½•å†…å®¹ã€‚

**å‚æ•°**

| åç§° | ç±»å‹ | æè¿° |
| ---- | ---- | ----------- |
| `setup` | [`cview_setup`](/api/common-types/cview-setup "æè¿°è§†å›¾è®¾ç½®å‚æ•°ã€‚") | è§†å›¾è®¾ç½®ä¿¡æ¯ã€‚ |

**ç¤ºä¾‹**

```lua
events.override_view:add(function(setup)
  setup.fov = 90
  print('View overridden with new FOV:', setup.fov)
end)
```

### event

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

åœ¨æ¯æ¬¡æ¸¸æˆäº‹ä»¶è§¦å‘æ—¶è°ƒç”¨ã€‚

> æˆ‘ä»¬å¹¶ä¸ç›‘å¬æ¸¸æˆä¸­å­˜åœ¨çš„æ¯ä¸ªäº‹ä»¶ã€‚å¦‚æœæ‚¨éœ€è¦æˆ‘ä»¬æ²¡æœ‰ç›‘å¬çš„äº‹ä»¶ï¼Œè¯·ä½¿ç”¨ [`mods.events`](/api/events/event-t "æ­¤æ¨¡å—å…è®¸æ‚¨ç®¡ç†è‡ªå®šä¹‰æ¸¸æˆå†…äº‹ä»¶ç›‘å¬å™¨ã€‚")

| åç§° | ç±»å‹ | æè¿° |
| ---- | ---- | ----------- |
| `event` | [`game_event_t`](/api/common-types/game-event-t "æè¿°æ¸¸æˆäº‹ä»¶ã€‚") | æ¸¸æˆäº‹ä»¶ã€‚ |

**ç¤ºä¾‹**

```lua
events.event:add(function(event)
  print('Game event triggered:', event.name)
end)
```

### handle_input

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

æ¯æ¬¡æ¸¸æˆå¤„ç†é¼ æ ‡/æ§åˆ¶å™¨è¾“å…¥æ—¶è°ƒç”¨ã€‚å¦‚æœéœ€è¦ï¼Œè¿™æ˜¯æ”¹å˜é¼ æ ‡ç§»åŠ¨çš„å¥½åœ°æ–¹ã€‚

**å‚æ•°**

| åç§° | ç±»å‹ | æè¿° |
| ---- | ---- | ----------- |
| `type` | [`input_type_t`](/api/enums/input-bit-mask.md) | è¾“å…¥ç±»å‹ã€‚ |
| `value` | [`ref_holder_t<float>`](/api/types/ref-holder-t.md) | è¾“å…¥çŠ¶æ€ã€‚ |

**ç¤ºä¾‹**

```lua
events.handle_input:add(function(type, value)
  --
end)
```

### input

[![å­—æ®µ][è¿™æ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨ç‚¹(.)è®¿é—®çš„å¸¸è§„å­—æ®µã€‚]rw]

åœ¨ GUI æ¯æ¬¡å¤„ç†è¾“å…¥æ—¶è°ƒç”¨ã€‚

**å‚æ•°**

| åç§° | ç±»å‹ | æè¿° |
| ---- | ---- | ----------- |
| `msg` | `int` | ç³»ç»Ÿæ¶ˆæ¯ã€‚[æ–‡æ¡£](https://learn.microsoft.com/en-us/windows/win32/winmsg/about-messages-and-message-queues#system-defined-messages) |
| `w` | `int` | WPARAMã€‚ |
| `l` | `int` | LPARAMã€‚ |

**ç¤ºä¾‹**

```lua
events.input:add(function(msg, w, l)
  print('Input received:', msg, w, l)
end)
```